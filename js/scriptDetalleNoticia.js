// IMPORTANTE: Esta base de datos debe ser IDÉNTICA a la de script.js
// Base de datos completa de noticias con contenido extendido
const fullNewsDatabase = [
    {
        id: 1,
        title: "La UAS es primer lugar entre las universidades públicas estatales del país y tercer lugar general por cuarto año consecutivo, de acuerdo con el Ranking Mundial de Universidades de Times Higher Education",
        shortDescription: "Por sus indicadores de excelencia, la Universidad Autónoma de Sinaloa (UAS) se ubica en el primer lugar entre las universidades públicas estatales del país y por cuarto año consecutivo se mantiene en el tercer lugar entre las instituciones mexicanas, tanto públicas ...",
        date: "2025-10-09",
        category: "actividades-generales",
        categoryLabel: "ACTIVIDADES GENERALES",
        thumbnailImage: "https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=600&h=400&fit=crop",
        heroImage: "https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=1200&h=600&fit=crop",
        content: [
            "Por sus indicadores de excelencia, la Universidad Autónoma de Sinaloa (UAS) se ubica en el primer lugar entre las universidades públicas estatales del país y por cuarto año consecutivo se mantiene en el tercer lugar entre las instituciones mexicanas, tanto públicas como privadas, de acuerdo con el Ranking Mundial de Universidades elaborado y difundido por el Times Higher Education (THE), instrumento de medición de indicadores más grande y diverso en el sector académico del mundo.",
            "Este Ranking dio a conocer los resultados este jueves y evalúa indicadores como la docencia, la calidad de la investigación y su impacto, la vinculación con los sectores productivos, la internacionalización y las publicaciones de impacto donde se toma en cuenta las veces que son citados los investigadores en otras partes del mundo, entre otros aspectos.",
            "En esta clasificación aparecen más de 200 universidades de México y cerca de 2 mil a nivel internacional, y la UAS aparece como la primera Universidad Pública Estatal de México y en tercera posición general entre las universidades mexicanas por debajo del Instituto Tecnológico de Estudios Superiores de Monterrey (ITESM), que es una universidad privada y la UNAM, que es una universidad nacional.",
            "Esta información representa un gran logro para la Casa Rosalina y toda su comunidad, sobre todo porque tanto alumnos como docentes, investigadores y trabajadores administrativos aportan un granito de arena para mantener o mejorar los indicadores de calidad de la institución.",
            "El Ranking Mundial de Universidades del Times Higher Education señala que en Ciencias del Deporte la UAS se coloca en primer lugar nacional; en Arqueología donde entra Antropología, Historia, Filosofía y Veterinaria en segundo lugar; y en las áreas de Estudios Internacionales, Contabilidad, Finanzas y Agricultura en tercer lugar nacional.",
            "Actualmente la Universidad Autónoma de Sinaloa se mantiene en un proceso de Reingeniería Integral, que, aunado a la política institucional encabezada por el Rector, doctor Jesús Madueña Molina y plasmada en el Plan de Desarrollo Institucional Con Visión de Futuro 2029, se propone avanzar en las cinco funciones sustantivas y seguir fortaleciéndolas.",
            "Por todo lo anterior, es compromiso de esta máxima casa de estudios continuar ofreciendo una educación y servicios de calidad que le permitan acrecentar sus indicadores para seguir mejorando en las evaluaciones nacionales e internacionales."
        ],
        videoUrl: "https://www.youtube.com/embed/dQw4w9WgXcQ",
        gallery: [
            "https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=400&h=300&fit=crop",
            "https://images.unsplash.com/photo-1517486808906-6ca8b3f04846?w=400&h=300&fit=crop",
            "https://images.unsplash.com/photo-1562774053-701939374585?w=400&h=300&fit=crop",
            "https://images.unsplash.com/photo-1491975474562-1f4e30bc9468?w=400&h=300&fit=crop"
        ]
    },
    {
        id: 2,
        title: "Es necesario centrarse en el bienestar emocional y cognitivo tanto de los pacientes de cáncer de mama como de sus acompañantes para rescatar la resiliencia, la salud y el amor propio",
        shortDescription: "Contar con redes de apoyo y resiliencia es de gran importancia cuando las personas reciben un diagnóstico de cáncer de mama, pero estos individuos deben estar preparados y conocer que pueden acercarse con personas indicadas que les ayuden a recover todo ...",
        date: "2025-10-09",
        category: "actividades-generales",
        categoryLabel: "ACTIVIDADES GENERALES",
        thumbnailImage: "https://images.unsplash.com/photo-1579154204601-01588f351e67?w=600&h=400&fit=crop",
        heroImage: "https://images.unsplash.com/photo-1579154204601-01588f351e67?w=1200&h=600&fit=crop",
        content: [
            "Contar con redes de apoyo y resiliencia es de gran importancia cuando las personas reciben un diagnóstico de cáncer de mama, pero estos individuos deben estar preparados y conocer que pueden acercarse con personas indicadas que les ayuden a recuperarse de todo este proceso, pues es un padecimiento que no solamente daña la salud física de los pacientes, sino también su salud emocional y mental.",
            "Lo anterior fue expresado por la Dra. María del Carmen Ayala, especialista en oncología y coordinadora del programa de apoyo psicológico para pacientes oncológicos de la Universidad Autónoma de Sinaloa, quien destacó la importancia de abordar de manera integral el tratamiento del cáncer de mama.",
            "Durante su participación en el Conversatorio sobre Cáncer de Mama, organizado por la Facultad de Medicina de la UAS, la especialista enfatizó que el apoyo emocional es fundamental tanto para los pacientes como para sus familiares y acompañantes.",
            "La doctora Ayala explicó que el impacto emocional del diagnóstico puede ser devastador, generando ansiedad, depresión y una sensación de pérdida de control sobre la propia vida. Por ello, es esencial que los pacientes cuenten con herramientas psicológicas que les permitan enfrentar el proceso de tratamiento de manera más efectiva."
        ],
        videoUrl: null,
        gallery: [
            "https://images.unsplash.com/photo-1579154204601-01588f351e67?w=400&h=300&fit=crop",
            "https://images.unsplash.com/photo-1578357078586-491adf1aa5ba?w=400&h=300&fit=crop"
        ]
    },
    {
        id: 3,
        title: "Comprometida socialmente, la UAS llevará a cabo consultas oftalmológicas gratuitas en el CIDOCS, en el marco del Día Mundial de la Visión",
        shortDescription: "La Universidad Autónoma de Sinaloa (UAS), en su compromiso permanente de servir a la sociedad, estará llevando a cabo más de 100 consultas oftalmológicas gratuitas este viernes 10 de octubre conmemorando el Día Mundial de la Visión, por lo que se ...",
        date: "2025-10-09",
        category: "actividades-generales",
        categoryLabel: "ACTIVIDADES GENERALES",
        thumbnailImage: "https://images.unsplash.com/photo-1551884170-09fb70a3a2ed?w=600&h=400&fit=crop",
        heroImage: "https://images.unsplash.com/photo-1551884170-09fb70a3a2ed?w=1200&h=600&fit=crop",
        content: [
            "La Universidad Autónoma de Sinaloa (UAS), en su compromiso permanente de servir a la sociedad, estará llevando a cabo más de 100 consultas oftalmológicas gratuitas este viernes 10 de octubre conmemorando el Día Mundial de la Visión, por lo que se invita a la población vulnerable a acercarse al Centro de Investigación y Docencia en Ciencias de la Salud (CIDOCS).",
            "Esta iniciativa forma parte del programa de vinculación de la Facultad de Medicina con la comunidad, buscando brindar atención médica de calidad a sectores de la población que no tienen acceso a servicios de salud visual.",
            "El Dr. Héctor Ponce Regalado, Director del CIDOCS, informó que se contará con la participación de especialistas en oftalmología y estudiantes de últimos semestres de medicina, quienes realizarán las consultas bajo supervisión académica.",
            "Las consultas incluirán evaluación de agudeza visual, detección de enfermedades oculares comunes y, en caso necesario, canalización a tratamiento especializado. Además, se proporcionará información sobre cuidado preventivo de la salud visual."
        ],
        videoUrl: null,
        gallery: [
            "https://images.unsplash.com/photo-1551884170-09fb70a3a2ed?w=400&h=300&fit=crop",
            "https://images.unsplash.com/photo-1559757148-5c350d0d3c56?w=400&h=300&fit=crop",
            "https://images.unsplash.com/photo-1582560475093-ba66accbc424?w=400&h=300&fit=crop"
        ]
    },
    {
        id: 4,
        title: "La UAS, a través de la Licenciatura en Gestión Turística, participa en el Tianguis Turístico 2025",
        shortDescription: "La Universidad Autónoma de Sinaloa (UAS), a través de la Licenciatura en Gestión Turística de la Facultad de Ciencias Económicas y Sociales, participa en el Tianguis Turístico 2025 que se lleva a cabo en Acapulco...",
        date: "2025-10-09",
        category: "actividades-generales",
        categoryLabel: "ACTIVIDADES GENERALES",
        thumbnailImage: "https://images.unsplash.com/photo-1469854523086-cc02fe5d8800?w=600&h=400&fit=crop",
        heroImage: "https://images.unsplash.com/photo-1469854523086-cc02fe5d8800?w=1200&h=600&fit=crop",
        content: [
            "La Universidad Autónoma de Sinaloa (UAS), a través de la Licenciatura en Gestión Turística de la Facultad de Ciencias Económicas y Sociales, participa en el Tianguis Turístico 2025 que se lleva a cabo en Acapulco, Guerrero, el evento más importante de la industria turística en México.",
            "Esta participación representa una oportunidad invaluable para que estudiantes y docentes de la carrera establezcan contacto directo con los principales actores del sector turístico nacional e internacional.",
            "Durante el evento, la delegación de la UAS tendrá la oportunidad de conocer las últimas tendencias en turismo sostenible, turismo de aventura, y las nuevas tecnologías aplicadas al sector.",
            "El Dr. Roberto Domínguez, coordinador de la Licenciatura en Gestión Turística, destacó que esta experiencia permitirá a los estudiantes ampliar su visión sobre las oportunidades profesionales en el campo del turismo."
        ],
        videoUrl: null,
        gallery: [
            "https://images.unsplash.com/photo-1469854523086-cc02fe5d8800?w=400&h=300&fit=crop",
            "https://images.unsplash.com/photo-1488646953014-85cb44e25828?w=400&h=300&fit=crop"
        ]
    },
    {
        id: 5,
        title: "Investigadores de la UAS presentan avances en biotecnología marina",
        shortDescription: "El equipo de investigación de la Facultad de Ciencias del Mar ha logrado importantes avances en el desarrollo de nuevas técnicas de cultivo sustentable de especies marinas, lo que representa un gran avance para la industria acuícola de la región...",
        date: "2025-09-28",
        category: "investigacion",
        categoryLabel: "INVESTIGACIÓN",
        thumbnailImage: "https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=600&h=400&fit=crop",
        heroImage: "https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=1200&h=600&fit=crop",
        content: [
            "El equipo de investigación de la Facultad de Ciencias del Mar de la Universidad Autónoma de Sinaloa ha logrado importantes avances en el desarrollo de nuevas técnicas de cultivo sustentable de especies marinas, lo que representa un gran avance para la industria acuícola de la región.",
            "Los investigadores, liderados por el Dr. Fernando Vega, han desarrollado un protocolo innovador que permite optimizar el crecimiento de camarón en condiciones controladas, reduciendo significativamente el impacto ambiental de la actividad acuícola.",
            "Este proyecto, financiado por el Consejo Nacional de Humanidades, Ciencias y Tecnologías (CONAHCYT), ha durado tres años y ha involucrado la participación de estudiantes de posgrado y licenciatura."
        ],
        videoUrl: null,
        gallery: [
            "https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=400&h=300&fit=crop",
            "https://images.unsplash.com/photo-1535591273668-578e31182c4f?w=400&h=300&fit=crop"
        ]
    },
    {
        id: 6,
        title: "UAS inaugura nuevo laboratorio de inteligencia artificial",
        shortDescription: "Con tecnología de punta y equipamiento de última generación, la universidad abre sus puertas a un espacio dedicado al desarrollo de proyectos de IA que beneficiarán tanto a la comunidad estudiantil como al sector empresarial...",
        date: "2025-08-15",
        category: "academico",
        categoryLabel: "ACADÉMICO",
        thumbnailImage: "https://images.unsplash.com/photo-1485827404703-89b55fcc595e?w=600&h=400&fit=crop",
        heroImage: "https://images.unsplash.com/photo-1485827404703-89b55fcc595e?w=1200&h=600&fit=crop",
        content: [
            "Con tecnología de punta y equipamiento de última generación, la Universidad Autónoma de Sinaloa inauguró oficialmente su nuevo Laboratorio de Inteligencia Artificial, un espacio dedicado al desarrollo de proyectos innovadores que beneficiarán tanto a la comunidad estudiantil como al sector empresarial de la región.",
            "El laboratorio cuenta con 50 estaciones de trabajo equipadas con procesadores de alto rendimiento y tarjetas gráficas especializadas para procesamiento de datos masivos y entrenamiento de modelos de aprendizaje automático.",
            "Durante la ceremonia inaugural, el Rector de la UAS destacó que este laboratorio posiciona a la institución a la vanguardia en la formación de profesionales especializados en tecnologías emergentes."
        ],
        videoUrl: null,
        gallery: [
            "https://images.unsplash.com/photo-1485827404703-89b55fcc595e?w=400&h=300&fit=crop",
            "https://images.unsplash.com/photo-1550751827-4bd374c3f58b?w=400&h=300&fit=crop"
        ]
    }
];

// Función para obtener parámetro de URL
function getUrlParameter(name) {
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get(name);
}

// Función para formatear fecha
function formatDate(dateString) {
    const months = [
        'Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio',
        'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'
    ];
    
    const date = new Date(dateString + 'T00:00:00');
    const day = String(date.getDate()).padStart(2, '0');
    const month = months[date.getMonth()];
    const year = date.getFullYear();
    
    return month + ' ' + day + ', ' + year;
}

// Función para cargar la noticia
function loadNews() {
    const newsIdParam = getUrlParameter('id');
    const newsId = parseInt(newsIdParam);
    
    // Si no hay ID, redirigir a index
    if (!newsIdParam || isNaN(newsId)) {
        console.error('No se proporcionó un ID válido. Redirigiendo...');
        window.location.href = 'index.html';
        return;
    }
    
    const news = fullNewsDatabase.find(function(n) { 
        return n.id === newsId; 
    });
    
    if (!news) {
        console.error('Noticia no encontrada con ID:', newsId);
        const mainContent = document.querySelector('.main-content');
        mainContent.innerHTML = '<div style="padding: 40px; text-align: center;"><h2>Noticia no encontrada</h2><p>La noticia que buscas no existe.</p><a href="index.html" style="color: #0066cc; text-decoration: none;">← Volver a noticias</a></div>';
        return;
    }
    
    console.log('Noticia cargada:', news);
    
    // Cargar imagen hero
    document.getElementById('hero-image').src = news.heroImage;
    document.getElementById('hero-image').alt = news.title;
    
    // Cargar título en hero
    document.getElementById('news-title').textContent = news.title;
    
    // Cargar fecha
    document.getElementById('news-date').textContent = formatDate(news.date);
    
    // Cargar título completo
    document.getElementById('news-full-title').textContent = news.title;
    
    // Cargar contenido
    const contentContainer = document.getElementById('news-content');
    const contentHTML = news.content.map(function(paragraph) {
        return '<p>' + paragraph + '</p>';
    }).join('');
    contentContainer.innerHTML = contentHTML;
    
    // Cargar video si existe
    if (news.videoUrl) {
        const videoContainer = document.getElementById('news-video');
        videoContainer.style.display = 'block';
        videoContainer.innerHTML = '<iframe src="' + news.videoUrl + '" allowfullscreen></iframe>';
    }
    
    // Cargar galería
    if (news.gallery && news.gallery.length > 0) {
        const galleryContainer = document.getElementById('gallery-images');
        const galleryHTML = news.gallery.map(function(img) {
            return '<img src="' + img + '" alt="Imagen relacionada" onclick="window.open(\'' + img + '\', \'_blank\')">';
        }).join('');
        galleryContainer.innerHTML = galleryHTML;
        
        initGalleryNavigation();
    }
    
    // Configurar botones de compartir
    setupSocialSharing(news);
    
    // Cargar otras noticias
    loadOtherNews(newsId);
}

// Función para configurar compartir en redes sociales
function setupSocialSharing(news) {
    const url = encodeURIComponent(window.location.href);
    const title = encodeURIComponent(news.title);
    
    // Facebook
    const facebookUrl = 'https://www.facebook.com/sharer/sharer.php?u=' + url;
    document.getElementById('share-facebook').href = facebookUrl;
    document.getElementById('share-facebook-bottom').href = facebookUrl;
    
    // Twitter
    const twitterUrl = 'https://twitter.com/intent/tweet?url=' + url + '&text=' + title;
    document.getElementById('share-twitter').href = twitterUrl;
    document.getElementById('share-twitter-bottom').href = twitterUrl;
    
    // Google+
    const googleUrl = 'https://plus.google.com/share?url=' + url;
    document.getElementById('share-google').href = googleUrl;
    document.getElementById('share-google-bottom').href = googleUrl;
}

// Función para cargar OTRAS noticias
function loadOtherNews(currentId) {
    // Obtener todas las noticias excepto la actual
    const otherNews = fullNewsDatabase.filter(function(n) {
        return n.id !== currentId;
    }).sort(function(a, b) {
        return new Date(b.date) - new Date(a.date);
    }).slice(0, 6);
    
    const container = document.getElementById('related-news');
    
    if (otherNews.length === 0) {
        container.innerHTML = '<p style="color: #666; font-size: 14px; padding: 20px;">No hay otras noticias disponibles.</p>';
        return;
    }
    
    const newsHTML = otherNews.map(function(news) {
        return '<div class="related-news-item"><p class="related-news-date">' + formatDate(news.date) + '</p><p class="related-news-title"><a href="noticia-detalle.html?id=' + news.id + '">' + news.title + '</a></p></div>';
    }).join('');
    
    container.innerHTML = newsHTML;
}

// Sistema de navegación de galería
let currentGalleryIndex = 0;
let galleryImages = [];

function initGalleryNavigation() {
    const container = document.getElementById('gallery-images');
    galleryImages = container.querySelectorAll('img');
    
    if (galleryImages.length <= 4) {
        document.getElementById('gallery-prev').style.display = 'none';
        document.getElementById('gallery-next').style.display = 'none';
        return;
    }
    
    updateGalleryButtons();
    
    document.getElementById('gallery-prev').addEventListener('click', function() {
        if (currentGalleryIndex > 0) {
            currentGalleryIndex--;
            updateGallery();
        }
    });
    
    document.getElementById('gallery-next').addEventListener('click', function() {
        if (currentGalleryIndex < galleryImages.length - 4) {
            currentGalleryIndex++;
            updateGallery();
        }
    });
}

function updateGallery() {
    const container = document.getElementById('gallery-images');
    const offset = currentGalleryIndex * -215;
    container.style.transform = 'translateX(' + offset + 'px)';
    updateGalleryButtons();
}

function updateGalleryButtons() {
    const prevBtn = document.getElementById('gallery-prev');
    const nextBtn = document.getElementById('gallery-next');
    
    prevBtn.disabled = currentGalleryIndex === 0;
    nextBtn.disabled = currentGalleryIndex >= galleryImages.length - 4;
}

// Inicializar al cargar la página
document.addEventListener('DOMContentLoaded', function() {
    console.log('Página cargada. URL actual:', window.location.href);
    loadNews();
});